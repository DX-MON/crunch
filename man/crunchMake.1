.\" Automatically generated by Pandoc 2.9.2.1
.\"
.TH "CRUNCHMAKE" "1" "" "crunch 1.0.0" "crunch unit testing framework"
.hy
.SH NAME
.PP
\f[B]crunchMake\f[R] - crunch and crunch++ test builder
.SH SYNOPSIS
.PP
\f[B]crunchMake\f[R] [\f[B]-h\f[R]|\f[B]--help\f[R]]
.PD 0
.P
.PD
\f[B]crunchMake\f[R] [\f[B]-v\f[R]|\f[B]--version\f[R]]
.PD 0
.P
.PD
\f[B]crunchMake\f[R] [\f[I]options\f[R]] \f[I]FILES\f[R]
.SH DESCRIPTION
.PP
crunchMake is a utility to build crunch and crunch++ unit tests.
.SH OPTIONS
.TP
-v, --version
Prints the version information for crunch
.TP
-h, --help
Prints this help message
.SS Compiler support
.TP
-l\f[B]library\f[R]
Adds \f[B]library\f[R] to the compiler library linking set
.TP
-I\f[B]dir\f[R]
Adds \f[B]dir\f[R] to the compiler include search path
.TP
-D\f[B]macro\f[R]
Adds \f[B]macro\f[R] to the compiler\[cq]s macro predefinitions
.TP
-L\f[B]dir\f[R]
Adds \f[B]dir\f[R] to the compiler library search path
.TP
-o \f[B]file\f[R]
Use \f[B]file\f[R] for the output test library
.TP
-pthread
Specify that you wish to build and link against pthreads
.TP
-Wl\f[B]option\f[R]
Adds \f[B]option\f[R] to the compiler-handled linker options
.TP
-std=\f[B]standard\f[R]
Sets the C or C++ standard to \f[B]standard\f[R].
In C++ mode, the minimimum supported standard is C++11.
In C mode, the minimum supported standard is C89.
.RS
.PP
This option must be specified in the form of either c\f[B]NN\f[R] or
c++\f[B]NN\f[R] where \f[B]NN\f[R] is the version number to use.
.RE
.TP
-z \f[B]keyword\f[R]
Specifies direct linker options - the exact meaning and options
available depend on your compiler\[cq]s specific linker.
.TP
--coverage
Enables linking against code that has been code-coverage enabled
.TP
--debug
Specifies that you wish the test to be built in debug mode crunchMake
defaults to building tests with level 2 (or equivilent) optimisations.
.TP
-fsanitize=\f[B]sanitizers\f[R]
Enable the comma separated list of sanitizers \f[B]sanitizers\f[R] on
the test being built
.SS Utility output options
.TP
--log
Tells the engine to log all test output to the file named
.TP
-s, --silent
Silences all output from crunchMake, leaving only compiler output on
stdout and stderr
.TP
-q, --quiet
Reduces output from crunchMake to kernel Makefile like output such as
\[cq] CCLD test.cxx => test.so\[cq]
.RS
.PP
By default, the utility will verbosely dump the full compiler
invocations it is running same as typical \f[C]make\f[R] style
utilities.
.RE
.PP
The files given on the crunchMake command line are gathered together and
passed as inputs to the compiler.
.PD 0
.P
.PD
This allows you to specify multiple TUs and additional object files to
be compiled and linked to the suite to produce a complete library
.SH FURTHER INFORMATION
.PP
\f[B]crunchMake\f[R] is a tool that aims to ensure a working build of
your tests without having to worry about exactly where
\f[B]\f[CB]crunch\f[B](1)\f[R] or \f[B]\f[CB]crunch++\f[B](1)\f[R] is
installed or how it was built.
.PP
It provides transparency for many compiler options, and platform- and
compiler-specific translations for the rest.
.PP
The important translated options when building test suites are:
.TP
--coverage
This option enables the compiler-specific code coverage options for the
build for when you do a code-coverage enabled build of your project
.TP
--debug
This option enables debugging information on the test suite to allow
setting breakpoints in the tests and inspecting state.
.RS
.PP
Example usage of such a build:
\f[B]\f[CB]gdb --args crunch++ testSuite\f[B]\f[R]
.RE
.PP
When compiling C++ test suites, \f[B]crunchMake\f[R] will automatically
feed the compiler with the visibility options
\f[B]\f[CB]-fvisbility-inlines-hidden\f[B]\f[R] and
\f[B]\f[CB]-fvisibility=hidden\f[B]\f[R] on GCC-like compilers.
.SS A simple crunch++ test suite
.PP
The following example can be used as a template for a minimum viable
useful test suite written using crunch++:
.IP
.nf
\f[C]
#include <crunch++.h>

class testSuite final : public testsuite
{
private:
    void testCase() { }

public:
    void registerTests() final
    {
        CRUNCHpp_TEST(testCase)
    }
};

CRUNCHpp_TESTS(testSuite)
\f[R]
.fi
.PP
Assuming this has been written out as test.cxx, compilation and
excecution of this example looks like:
.IP
.nf
\f[C]
$ crunchMake test.cxx
c++ -fPIC -DPIC -fvisibility=hidden -fvisibility-inlines-hidden -std=c++11  test.cxx -shared -I/usr/include -L/usr/lib -Wl,-rpath,/usr/lib -lcrunch++ -O2 -pthread -o test.so

$ crunch++ test
Running test suite test...
Running tests in class 9testSuite...
testCase...                                                                          [  OK  ]
Total tests: 1,  Failures: 0,  Pass rate: 100.00%
\f[R]
.fi
.SS A simple crunch test suite
.PP
The following example can be used as a template for a minimum viable
useful test suite written using crunch:
.IP
.nf
\f[C]
#include <crunch.h>

void testCase() { }

BEGIN_REGISTER_TESTS()
    TEST(testCase)
END_REGISTER_TESTS()
\f[R]
.fi
.PP
Assuming this has been written out as test.c, compilation and excecution
of this example looks like:
.IP
.nf
\f[C]
$ crunchMake test.c
cc -fPIC -DPIC  test.c -shared -I/usr/include -L/usr/lib -Wl,-rpath,/usr/lib -lcrunch -O2 -pthread -o test.so

$ crunch test
Running test suit test...
testCase...                                                                          [  OK  ]
Total tests: 1,  Failures: 0,  Pass rate: 100.00%
\f[R]
.fi
.SH BUGS
.PP
Report bugs using <https://github.com/DX-MON/crunch/issues>
.SH AUTHORS
.PP
Rachel Mant <dx-mon@users.sourceforge.net>
.SH SEE ALSO
.PP
\f[B]\f[CB]crunch\f[B](1)\f[R], \f[B]\f[CB]crunch++\f[B](1)\f[R]
